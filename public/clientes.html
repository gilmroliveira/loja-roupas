<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Clientes - Loja de Roupas</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background:#f5f5f5;
      margin:0;
    }
    header {
      background:#222;
      color:#fff;
      padding:16px 32px;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    header h1 { margin:0; }
    nav a {
      color:#fff;
      margin-right:12px;
      text-decoration:none;
    }
    nav a:hover { text-decoration:underline; }
    main {
      max-width:960px;
      margin:24px auto;
      background:#fff;
      padding:24px 32px;
      border-radius:8px;
      box-shadow:0 2px 8px rgba(0,0,0,0.08);
    }
    form {
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-bottom:16px;
    }
    form input {
      padding:6px 8px;
      flex:1 1 180px;
      border:1px solid #ccc;
      border-radius:4px;
    }
    form button {
      padding:8px 16px;
      background:#28a745;
      color:#fff;
      border:none;
      border-radius:4px;
      cursor:pointer;
    }
    form button:hover { background:#218838; }
    table {
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
    }
    th, td {
      border:1px solid #ddd;
      padding:8px;
      text-align:left;
    }
    th { background:#f0f0f0; }
    .btn {
      padding:4px 8px;
      border:none;
      border-radius:4px;
      cursor:pointer;
      font-size:12px;
    }
    .btn-editar {
      background:#ffc107;
    }
    .btn-editar:hover {
      background:#e0a800;
    }
    .btn-excluir {
      background:#dc3545;
      color:#fff;
    }
    .btn-excluir:hover {
      background:#c82333;
    }
  </style>
</head>
<body>
  <header>
    <h1>Clientes</h1>
    <nav>
      <a href="index.html">Início</a>
      <a href="pedidos.html">Pedidos</a>
    </nav>
  </header>

  <main>
    <h2>Cadastrar / Editar Cliente</h2>
    <form id="form-cliente">
      <input type="hidden" id="id_cliente" />
      <input type="text" id="nome" placeholder="Nome" required />
      <input type="email" id="email" placeholder="Email" required />
      <input type="text" id="telefone" placeholder="Telefone" required />
      <input type="text" id="endereco" placeholder="Endereço" required />
      <button type="submit">Salvar</button>
    </form>

    <h2>Lista de Clientes</h2>
    <table>
      <thead>
        <tr>
          <th>ID</th><th>Nome</th><th>Email</th><th>Telefone</th><th>Endereço</th><th>Ações</th>
        </tr>
      </thead>
      <tbody id="tbody-clientes"></tbody>
    </table>
  </main>

  <script>
    const apiBase = '/api/clientes';

    async function carregarClientes() {
      const res = await fetch(apiBase);
      const dados = await res.json();
      const tbody = document.getElementById('tbody-clientes');
      tbody.innerHTML = '';
      dados.forEach(c => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${c.id_cliente}</td>
          <td>${c.nome}</td>
          <td>${c.email}</td>
          <td>${c.telefone}</td>
          <td>${c.endereco}</td>
          <td>
            <button class="btn btn-editar"
              onclick="editar(${c.id_cliente}, '${c.nome}', '${c.email}', '${c.telefone}', '${c.endereco}')">
              Editar
            </button>
            <button class="btn btn-excluir" onclick="remover(${c.id_cliente})">
              Excluir
            </button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    document.getElementById('form-cliente').addEventListener('submit', async (e) => {
      e.preventDefault();
      const id = document.getElementById('id_cliente').value;
      const body = {
        nome: document.getElementById('nome').value,
        email: document.getElementById('email').value,
        telefone: document.getElementById('telefone').value,
        endereco: document.getElementById('endereco').value,
      };
      const metodo = id ? 'PUT' : 'POST';
      const url = id ? `${apiBase}/${id}` : apiBase;

      await fetch(url, {
        method: metodo,
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(body)
      });

      document.getElementById('form-cliente').reset();
      document.getElementById('id_cliente').value = '';
      carregarClientes();
    });

    async function remover(id) {
      if (!confirm('Deseja realmente excluir este cliente?')) return;
      await fetch(`${apiBase}/${id}`, { method: 'DELETE' });
      carregarClientes();
    }

    function editar(id, nome, email, telefone, endereco) {
      document.getElementById('id_cliente').value = id;
      document.getElementById('nome').value = nome;
      document.getElementById('email').value = email;
      document.getElementById('telefone').value = telefone;
      document.getElementById('endereco').value = endereco;
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    carregarClientes();
  </script>
</body>
</html>
